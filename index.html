<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Halo AAC ‚Äî Offline Web</title>
<link rel="icon" href="data:," />
<style>
:root {
  --accent: #2c7be5;
  --bg: #f3f4f6;
  --card: #ffffff;
  --muted: #666;
  --radius: 10px;
}
* { box-sizing: border-box; }
body {
  margin:0; font-family:"Segoe UI",Roboto,Arial,sans-serif; background:var(--bg); color:#111; -webkit-font-smoothing:antialiased;
}
header { display:flex; justify-content:space-between; align-items:center; padding:12px 18px; background:linear-gradient(90deg,#0b63d6,#2c7be5); color:#fff; }
header h1 { margin:0; font-size:20px; }
header .subtitle { font-size:12px; opacity:0.8; }
.icon-btn { background:transparent; border:0; color:#fff; cursor:pointer; font-size:18px; padding:6px; border-radius:6px; }
.icon-btn:hover { background: rgba(255,255,255,0.06); }
main { max-width:1100px; margin:18px auto; padding:16px; }
.profile-row { display:flex; align-items:center; gap:8px; margin-bottom:12px; }
select, button, input, textarea { font-family:inherit; }
.btn { background:var(--accent); border:0; color:#fff; padding:8px 10px; border-radius:8px; cursor:pointer; }
.btn.ghost { background:transparent; color:var(--accent); border:1px solid rgba(44,123,229,0.12); }
.controls { display:flex; flex-wrap:wrap; gap:10px; align-items:center; margin-bottom:12px; }
.categories { display:flex; flex-wrap:wrap; gap:8px; margin-bottom:12px; }
.cat-btn { background:var(--card); border:1px solid #e6e6e6; padding:8px 12px; border-radius:999px; cursor:pointer; }
.cat-btn.active { background:var(--accent); color:#fff; border-color:transparent; }
.panel { display:flex; gap:16px; flex-wrap:wrap; }
.left { flex:1 1 360px; min-width:280px; }
.right { flex:2 1 620px; min-width:320px; }
.card { background:var(--card); border-radius:var(--radius); padding:12px; box-shadow:0 6px 18px rgba(15,15,15,0.04); margin-bottom:12px; }
#word-grid { display:grid; gap:8px; grid-template-columns:repeat(auto-fill,minmax(110px,1fr)); }
.word-btn { display:flex; flex-direction:column; align-items:center; justify-content:center; height:86px; font-size:15px; border:1px solid #eee; border-radius:10px; background:#fff; cursor:pointer; }
.word-emoji { font-size:22px; margin-bottom:6px; }
textarea#message { width:100%; padding:10px; border-radius:8px; border:1px solid #ddd; min-height:56px; font-size:16px; resize:none; }
ul#predictions { list-style:none; margin:8px 0 0; padding:0; max-height:140px; overflow:auto; border-radius:6px; }
#predictions li { padding:8px; border-bottom:1px solid #f0f0f0; cursor:pointer; }
#predictions li:hover { background:#f5f7fb; }
#settingsMenu { display:none; position:fixed; top:64px; right:18px; width:320px; background:var(--card); padding:12px; border-radius:10px; box-shadow:0 8px 22px rgba(0,0,0,0.12); z-index:999; }
#settingsMenu label { display:block; margin-bottom:8px; font-size:13px; color:var(--muted); }
#settingsMenu select, #settingsMenu input, #settingsMenu textarea { width:100%; padding:8px; margin-top:6px; border-radius:6px; border:1px solid #e6e6e6; }
footer { padding:18px; text-align:center; color:#777; font-size:13px; }
@media(max-width:720px){ .panel{flex-direction:column;} .right{order:2;} .left{order:1;} .cat-btn{font-size:14px;padding:6px 10px;} }
</style>
</head>
<body>

<header>
  <div style="display:flex;align-items:center;gap:12px;">
    <img src="logo.png" alt="Halo Logo" style="height:32px;">
    <div><h1>Halo AAC ‚Äî Offline</h1><span class="subtitle">Thanks Kaelynn Partlow</span></div>
  </div>
  <div class="top-controls">
    <button id="settingsBtn" class="icon-btn" title="Settings">‚öôÔ∏è</button>
    <select id="voiceSelect" aria-label="Voice selector"></select>
  </div>
</header>

<main>
  <div class="profile-row">
    <label style="display:flex;align-items:center;gap:8px;">Profile:
      <select id="profileSelect"></select>
    </label>
    <button id="addProfile" class="btn ghost">Add Profile</button>
    <button id="delProfile" class="btn ghost">Delete</button>
    <div style="margin-left:auto;display:flex;gap:8px;align-items:center;">
      <button id="exportBtn" class="btn ghost">Export</button>
      <button id="importBtn" class="btn">Import</button>
    </div>
  </div>

  <div class="controls">
    <div class="categories card" id="categoryBar"></div>
    <div style="margin-left:auto;display:flex;gap:8px;align-items:center;">
      <button id="addWordBtn" class="btn">Add Word</button>
      <button id="addCategoryBtn" class="btn">Add Category</button>
      <button id="clearBtn" class="btn ghost">Clear</button>
    </div>
  </div>

  <div class="panel">
    <div class="left">
      <div class="card">
        <label for="message">Message</label>
        <textarea id="message" readonly placeholder="Click words..."></textarea>
        <ul id="predictions"></ul>
        <div style="display:flex;gap:8px;margin-top:8px;">
          <button id="speakBtn" class="btn">Speak</button>
          <button id="stopBtn" class="btn ghost">Stop</button>
        </div>
      </div>
      <div class="card">
        <strong>Profile Data</strong>
        <div id="profileData" style="margin-top:8px;color:#444;font-size:14px;">No profile selected</div>
      </div>
    </div>

    <div class="right">
      <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center;">
          <strong id="gridTitle">All Words</strong>
          <div style="color:var(--muted);font-size:13px;">Tap a word to append</div>
        </div>
        <div id="word-grid" style="margin-top:12px;"></div>
      </div>
    </div>
  </div>
</main>

<div id="settingsMenu">
  <label>Voice<select id="settingsVoice"></select></label>
  <label>Background<input type="color" id="bgColorPicker" value="#f3f4f6"></label>
  <label>Export/Import
    <div style="display:flex;gap:8px;">
      <button id="doExport" class="btn ghost" style="flex:1;">Generate</button>
      <button id="doImport" class="btn" style="flex:1;">Apply</button>
    </div>
  </label>
  <textarea id="importArea" placeholder="Paste code" style="min-height:80px;padding:8px;border-radius:6px;border:1px solid #e6e6e6;"></textarea>
  <button id="closeSettings" class="btn ghost" style="width:100%;margin-top:10px;">Close</button>
</div>

<footer>
Offline AAC. Export code to save data. Thanks Kaelynn Partlow.
</footer>

<script>
// ========== DATA ==========
const STORAGE_KEY = 'halo_aac_data_v5';
let data = JSON.parse(localStorage.getItem(STORAGE_KEY)||'{"profiles":{},"currentProfile":null,"lastVoice":""}');
const CATEGORIES = {
  'Default': [
    'Hello üí¨','Yes ‚úÖ','No ‚ùå','Thank you üôè','Please üôè','Water üíß','Eat üçé','Bathroom üöΩ',
    'Good morning üåÖ','Good night üåô','Sleep üõå','Play üèÄ','Run üèÉ‚Äç‚ôÇÔ∏è','Walk üö∂‚Äç‚ôÇÔ∏è','Sit ü™ë','Stand üßç‚Äç‚ôÇÔ∏è',
    'Happy üòÄ','Sad üò¢','Angry üò°','Surprised üò≤','Love ‚ù§Ô∏è','Like üëç','Dislike üëé','Friend ü§ù','Family üë™','School üè´',
    'Book üìñ','Pen üñäÔ∏è','Music üéµ','Dance üíÉ','Sing üé§','Car üöó','Bus üöå','Bike üö≤','Phone üì±','Computer üíª',
    'TV üì∫','Movie üé¨','Game üéÆ','Food üçî','Drink ü•§','Ice cream üç¶','Cake üéÇ','Cookie üç™','Fruit üçì','Vegetable ü•¶',
    'Dog üê∂','Cat üê±','Bird üê¶','Fish üêü','Animal üêæ','Tree üå≥','Flower üå∏','Sun ‚òÄÔ∏è','Moon üåô','Star ‚≠ê',
    'Rain üåßÔ∏è','Snow ‚ùÑÔ∏è','Wind üå¨Ô∏è','Fire üî•','Earth üåç','Air üí®','Home üè†','Store üè¨','Help üÜò','Stop ‚úã',
    'Go üü¢','Wait ‚è≥','Now ‚è∞','Later üïí','Hot üå°Ô∏è','Cold ‚ùÑÔ∏è','Big üèîÔ∏è','Small üêú','Fast üèéÔ∏è','Slow üê¢',
    'Up ‚¨ÜÔ∏è','Down ‚¨áÔ∏è','Left ‚¨ÖÔ∏è','Right ‚û°Ô∏è','Open üîì','Close üîí','Inside üè†','Outside üå≥','Clean üßπ','Dirty üßº',
    'Wash üßΩ','Eat üçΩÔ∏è','Drink ü•õ','Wake up ‚è∞','Play ‚öΩ','Read üìö','Write ‚úçÔ∏è','Listen üëÇ','See üëÄ','Touch ‚úã',
    'Smell üëÉ','Taste üëÖ','Think ü§î','Maybe ü§∑‚Äç‚ôÇÔ∏è','Sorry üòî','Excited ü§©','Tired üò¥','Scared üò±','Hate üíî',
    'Morning üåÖ','Afternoon üåá','Evening üåÜ','Night üåÉ','Today üìÖ','Tomorrow üìÜ','Yesterday üìÖ','Soon ‚è±Ô∏è','Apple üçé','Banana üçå',
    'Orange üçä','Grapes üçá','Strawberry üçì','Cherry üçí','Watermelon üçâ','Peach üçë','Pear üçê','Lemon üçã','Bread üçû','Milk ü•õ',
    'Cheese üßÄ','Egg ü•ö','Butter üßà','Rice üçö','Pasta üçù','Pizza üçï','Burger üçî','Fries üçü','Coffee ‚òï','Tea üçµ',
    'Juice üßÉ','Soda ü•§','Ball ‚öΩ','Doll ü™Ü','Toy üöÇ','Puzzle üß©','Draw üé®','Think ü§î','Sing üé§','Dance üíÉ',
    'Phone üì±','Computer üíª','TV üì∫','Music üéµ','Movie üé¨','Game üéÆ','Car üöó','Bus üöå','Bike üö≤','Train üöÜ',
    'Plane ‚úàÔ∏è','Boat üö§','House üè†','Apartment üè¢','Tree üå≥','Flower üå∫','Grass üå±','Sun üåû','Moon üåô','Star ‚≠ê',
    'Cloud ‚òÅÔ∏è','Rain üåßÔ∏è','Snow ‚ùÑÔ∏è','Wind üå¨Ô∏è','Dog üêï','Cat üêà','Bird üê¶','Fish üêü','Horse üêé','Cow üêÑ',
    'Chicken üêì','Pig üêñ','Sheep üêë','Goat üêê','Apple üçé','Banana üçå','Orange üçä','Grapes üçá','Strawberry üçì','Cherry üçí',
    'Watermelon üçâ','Peach üçë','Pear üçê','Lemon üçã','Bread üçû','Milk ü•õ','Cheese üßÄ','Egg ü•ö','Butter üßà','Rice üçö'
  ]
};

// ========== VOICES ==========
let voices = [];
function loadVoices(){
  voices = speechSynthesis.getVoices();
  const select = document.getElementById('voiceSelect');
  const settingsSelect = document.getElementById('settingsVoice');
  select.innerHTML = settingsSelect.innerHTML = '';
  voices.forEach(v=>{
    const option = document.createElement('option');
    option.value = v.name; option.textContent = `${v.name} (${v.lang})`;
    select.appendChild(option);
    settingsSelect.appendChild(option.cloneNode(true));
  });
  const last = data.lastVoice;
  if(last && voices.find(v=>v.name===last)){
    select.value = last; settingsSelect.value = last;
  }
}
speechSynthesis.onvoiceschanged = loadVoices;
loadVoices();

// ========== DOM ==========
const profileSelect = document.getElementById('profileSelect');
const messageArea = document.getElementById('message');
const wordGrid = document.getElementById('word-grid');
const categoryBar = document.getElementById('categoryBar');
const predictionsList = document.getElementById('predictions');

// ========== FUNCTIONS ==========
function saveData(){
  localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
}
function populateProfiles(){
  profileSelect.innerHTML = '';
  for(const prof in data.profiles){
    const opt = document.createElement('option'); opt.value=prof; opt.textContent=prof;
    profileSelect.appendChild(opt);
  }
  profileSelect.value = data.currentProfile || '';
  updateProfileData();
}
function updateProfileData(){
  const info = document.getElementById('profileData');
  if(data.currentProfile && data.profiles[data.currentProfile]){
    info.textContent = JSON.stringify(data.profiles[data.currentProfile],null,2);
  } else info.textContent = 'No profile selected';
}
function addProfile(name){
  if(!name) return;
  data.profiles[name] = {words:{},categories:{}};
  data.currentProfile = name;
  populateProfiles(); saveData();
}
function deleteProfile(name){
  if(!name) return;
  delete data.profiles[name];
  data.currentProfile = Object.keys(data.profiles)[0]||null;
  populateProfiles(); saveData();
}
function appendWord(word){ messageArea.value += word+' '; updatePredictions(word); }
function speakMessage(){
  if(!messageArea.value) return;
  const utter = new SpeechSynthesisUtterance(messageArea.value);
  utter.voice = voices.find(v=>v.name===document.getElementById('voiceSelect').value)||null;
  speechSynthesis.speak(utter);
  data.lastVoice = utter.voice?.name||'';
  saveData();
}
function stopSpeaking(){ speechSynthesis.cancel(); }
function updatePredictions(lastWord){
  predictionsList.innerHTML = '';
  const words = Object.keys(CATEGORIES).flatMap(cat=>CATEGORIES[cat]);
  const preds = words.filter(w=>w.toLowerCase().startsWith(lastWord.toLowerCase()) && w!==lastWord).slice(0,5);
  preds.forEach(p=>{
    const li = document.createElement('li'); li.textContent = p;
    li.onclick=()=>appendWord(p);
    predictionsList.appendChild(li);
  });
}
function populateWords(category){
  wordGrid.innerHTML = '';
  const words = CATEGORIES[category]||[];
  words.forEach(w=>{
    const btn = document.createElement('div'); btn.className='word-btn';
    btn.innerHTML=`<div class="word-emoji">üí¨</div><div>${w}</div>`;
    btn.onclick=()=>appendWord(w);
    wordGrid.appendChild(btn);
  });
}
function populateCategories(){
  categoryBar.innerHTML='';
  Object.keys(CATEGORIES).forEach(cat=>{
    const btn = document.createElement('button'); btn.className='cat-btn'; btn.textContent=cat;
    btn.onclick=()=>{populateWords(cat); document.querySelectorAll('.cat-btn').forEach(b=>b.classList.remove('active')); btn.classList.add('active');};
    categoryBar.appendChild(btn);
  });
  document.querySelector('.cat-btn')?.click();
}

// ========== EVENTS ==========
document.getElementById('speakBtn').onclick=speakMessage;
document.getElementById('stopBtn').onclick=stopSpeaking;
document.getElementById('addProfile').onclick=()=>{ const name=prompt('Profile name:'); addProfile(name); };
document.getElementById('delProfile').onclick=()=>{ if(profileSelect.value) deleteProfile(profileSelect.value); };
profileSelect.onchange=()=>{ data.currentProfile=profileSelect.value; updateProfileData(); saveData(); };
document.getElementById('clearBtn').onclick=()=>{ messageArea.value=''; predictionsList.innerHTML=''; };
document.getElementById('settingsBtn').onclick=()=>{ document.getElementById('settingsMenu').style.display='block'; };
document.getElementById('closeSettings').onclick=()=>{ document.getElementById('settingsMenu').style.display='none'; };
document.getElementById('bgColorPicker').oninput=e=>{ document.body.style.background=e.target.value; };
document.getElementById('doExport').onclick=()=>{ document.getElementById('importArea').value = JSON.stringify(data); };
document.getElementById('doImport').onclick=()=>{
  try{
    const imported = JSON.parse(document.getElementById('importArea').value);
    data = imported; populateProfiles(); populateCategories(); saveData();
    alert('Import successful');
  }catch{ alert('Invalid JSON'); }
};
document.getElementById('addWordBtn').onclick=()=>{
  const w=prompt('New word:'); if(!w) return;
  const cat = prompt('Category (leave blank for Default):')||'Default';
  if(!CATEGORIES[cat]) CATEGORIES[cat]=[];
  CATEGORIES[cat].push(w);
  populateCategories();
};
document.getElementById('addCategoryBtn').onclick=()=>{
  const c=prompt('Category name:'); if(!c) return; if(!CATEGORIES[c]) CATEGORIES[c]=[]; populateCategories(); 
};

// ========== INIT ==========
populateProfiles();
populateCategories();
</script>

</body>
</html>
