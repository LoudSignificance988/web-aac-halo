<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Halo AAC ‚Äî Offline Web</title>
<link rel="icon" href="data:," />
<style>
:root {
  --accent: #2c7be5;
  --bg: #f3f4f6;
  --card: #ffffff;
  --muted: #666;
  --radius: 10px;
}
* { box-sizing: border-box; }
body {
  margin:0; font-family:"Segoe UI",Roboto,Arial,sans-serif; background:var(--bg); color:#111; -webkit-font-smoothing:antialiased;
}
header { display:flex; justify-content:space-between; align-items:center; padding:12px 18px; background:linear-gradient(90deg,#0b63d6,#2c7be5); color:#fff; }
header h1 { margin:0; font-size:20px; }
header .subtitle { font-size:12px; opacity:0.8; }
.icon-btn { background:transparent; border:0; color:#fff; cursor:pointer; font-size:18px; padding:6px; border-radius:6px; }
.icon-btn:hover { background: rgba(255,255,255,0.06); }
main { max-width:1100px; margin:18px auto; padding:16px; }
.profile-row { display:flex; align-items:center; gap:8px; margin-bottom:12px; }
select, button, input, textarea { font-family:inherit; }
.btn { background:var(--accent); border:0; color:#fff; padding:8px 10px; border-radius:8px; cursor:pointer; }
.btn.ghost { background:transparent; color:var(--accent); border:1px solid rgba(44,123,229,0.12); }
.controls { display:flex; flex-wrap:wrap; gap:10px; align-items:center; margin-bottom:12px; }
.categories { display:flex; flex-wrap:wrap; gap:8px; margin-bottom:12px; }
.cat-btn { background:var(--card); border:1px solid #e6e6e6; padding:8px 12px; border-radius:999px; cursor:pointer; }
.cat-btn.active { background:var(--accent); color:#fff; border-color:transparent; }
.panel { display:flex; gap:16px; flex-wrap:wrap; }
.left { flex:1 1 360px; min-width:280px; }
.right { flex:2 1 620px; min-width:320px; }
.card { background:var(--card); border-radius:var(--radius); padding:12px; box-shadow:0 6px 18px rgba(15,15,15,0.04); margin-bottom:12px; }
#word-grid { display:grid; gap:8px; grid-template-columns:repeat(auto-fill,minmax(110px,1fr)); }
.word-btn { display:flex; flex-direction:column; align-items:center; justify-content:center; height:86px; font-size:15px; border:1px solid #eee; border-radius:10px; background:#fff; cursor:pointer; }
.word-emoji { font-size:22px; margin-bottom:6px; }
textarea#message { width:100%; padding:10px; border-radius:8px; border:1px solid #ddd; min-height:56px; font-size:16px; resize:none; }
ul#predictions { list-style:none; margin:8px 0 0; padding:0; max-height:140px; overflow:auto; border-radius:6px; }
#predictions li { padding:8px; border-bottom:1px solid #f0f0f0; cursor:pointer; }
#predictions li:hover { background:#f5f7fb; }
footer { padding:18px; text-align:center; color:#777; font-size:13px; }
@media(max-width:720px){ .panel{flex-direction:column;} .right{order:2;} .left{order:1;} .cat-btn{font-size:14px;padding:6px 10px;} }
</style>
</head>
<body>

<header>
  <div style="display:flex;align-items:center;gap:12px;">
    <img src="logo.png" alt="Halo Logo" style="height:32px;">
    <div><h1>Halo AAC ‚Äî Offline</h1><span class="subtitle">Thanks Kaelynn Partlow</span></div>
  </div>
  <div class="top-controls">
    <button id="settingsBtn" class="icon-btn" title="Settings">‚öôÔ∏è</button>
    <select id="voiceSelect" aria-label="Voice selector"></select>
  </div>
</header>

<main>
  <div class="profile-row">
    <label style="display:flex;align-items:center;gap:8px;">Profile:
      <select id="profileSelect"></select>
    </label>
    <button id="addProfile" class="btn ghost">Add Profile</button>
    <button id="delProfile" class="btn ghost">Delete</button>
  </div>

  <div class="controls">
    <div class="categories card" id="categoryBar"></div>
    <div style="margin-left:auto;display:flex;gap:8px;align-items:center;">
      <button id="addWordBtn" class="btn">Add Word</button>
      <button id="addCategoryBtn" class="btn">Add Category</button>
      <button id="clearBtn" class="btn ghost">Clear</button>
    </div>
  </div>

  <div class="panel">
    <div class="left">
      <div class="card">
        <label for="message">Message</label>
        <textarea id="message" readonly placeholder="Click words..."></textarea>
        <ul id="predictions"></ul>
        <div style="display:flex;gap:8px;margin-top:8px;">
          <button id="speakBtn" class="btn">Speak</button>
          <button id="stopBtn" class="btn ghost">Stop</button>
        </div>
      </div>
    </div>

    <div class="right">
      <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center;">
          <strong id="gridTitle">All Words</strong>
          <div style="color:var(--muted);font-size:13px;">Tap a word to append</div>
        </div>
        <div id="word-grid" style="margin-top:12px;"></div>
      </div>
    </div>
  </div>
</main>

<footer>
Offline AAC. Thanks Kaelynn Partlow.
</footer>

<script>
// ========== DATA ==========
const STORAGE_KEY = 'halo_aac_data_v4';
let data = JSON.parse(localStorage.getItem(STORAGE_KEY)||'{"profiles":{},"currentProfile":null,"lastVoice":""}');
const CATEGORIES = {
  'Greetings': ['Hello üëã','Hi üòÉ','Good morning ‚òÄÔ∏è','Good night üåô','Bye üëã'],
  'Responses': ['Yes ‚úÖ','No ‚ùå','Please üôè','Thank you üôè','Sorry üòî'],
  'Food': ['Water üíß','Eat üçΩÔ∏è','Fruit üçé','Bread üçû','Milk ü•õ'],
  'Places': ['Home üè†','School üè´','Park üå≥','Store üè¨','Bathroom üöª'],
  'Emotions': ['Happy üòÑ','Sad üò¢','Angry üò°','Excited ü§©','Tired üò¥'],
  'Activities': ['Play ‚öΩ','Sleep üõå','Read üìñ','Draw üé®','Dance üíÉ'],
  'Family': ['Mom üë©','Dad üë®','Sister üëß','Brother üë¶','Grandma üëµ'],
  'Colors': ['Red üî¥','Blue üîµ','Green üü¢','Yellow üü°','Black ‚ö´'],
  'Numbers': ['One 1','Two 2','Three 3','Four 4','Five 5'],
  'Animals': ['Dog üê∂','Cat üê±','Bird üê¶','Fish üêü','Cow üêÑ']
};

// ========== VOICES ==========
let voices = [];
function loadVoices(){
  voices = speechSynthesis.getVoices();
  const select = document.getElementById('voiceSelect');
  select.innerHTML = '';
  voices.forEach(v=>{
    const option = document.createElement('option');
    option.value = v.name; option.textContent = `${v.name} (${v.lang})`;
    select.appendChild(option);
  });
}
speechSynthesis.onvoiceschanged = loadVoices;
loadVoices();

// ========== DOM ==========
const profileSelect = document.getElementById('profileSelect');
const messageArea = document.getElementById('message');
const wordGrid = document.getElementById('word-grid');
const categoryBar = document.getElementById('categoryBar');

// ========== FUNCTIONS ==========
function saveData(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(data)); }

function populateProfiles(){
  profileSelect.innerHTML = '';
  for(const prof in data.profiles){
    const opt = document.createElement('option'); opt.value=prof; opt.textContent=prof;
    profileSelect.appendChild(opt);
  }
  profileSelect.value = data.currentProfile || '';
}

function appendWord(word){ messageArea.value += word+' '; }

function speakMessage(){
  if(!messageArea.value) return;
  const utter = new SpeechSynthesisUtterance(messageArea.value);
  utter.voice = voices.find(v=>v.name===document.getElementById('voiceSelect').value)||null;
  speechSynthesis.speak(utter);
}

function stopSpeaking(){ speechSynthesis.cancel(); }

function populateWords(category){
  wordGrid.innerHTML = '';
  const words = CATEGORIES[category]||[];
  words.forEach(w=>{
    const btn = document.createElement('div'); btn.className='word-btn';
    btn.innerHTML=`<div class="word-emoji">${w.split(' ').slice(-1)}</div><div>${w.split(' ').slice(0,-1).join(' ')}</div>`;
    btn.onclick=()=>appendWord(w);
    wordGrid.appendChild(btn);
  });
}

function populateCategories(){
  categoryBar.innerHTML='';
  Object.keys(CATEGORIES).forEach(cat=>{
    const btn = document.createElement('button'); btn.className='cat-btn'; btn.textContent=cat;
    btn.onclick=()=>{populateWords(cat); document.querySelectorAll('.cat-btn').forEach(b=>b.classList.remove('active')); btn.classList.add('active');};
    categoryBar.appendChild(btn);
  });
  document.querySelector('.cat-btn')?.click();
}

// ========== EVENTS ==========
document.getElementById('speakBtn').onclick=speakMessage;
document.getElementById('stopBtn').onclick=stopSpeaking;
document.getElementById('clearBtn').onclick=()=>{ messageArea.value=''; };
document.getElementById('addWordBtn').onclick=()=>{
  const w=prompt('New word:'); if(!w) return;
  const cat = prompt('Category (leave blank for Default):')||'Default';
  if(!CATEGORIES[cat]) CATEGORIES[cat]=[];
  CATEGORIES[cat].push(w);
  populateCategories();
};
document.getElementById('addCategoryBtn').onclick=()=>{
  const c=prompt('Category name:'); if(!c) return; if(!CATEGORIES[c]) CATEGORIES[c]=[]; populateCategories(); 
};

// ========== INIT ==========
populateProfiles();
populateCategories();
</script>

</body>
</html>

