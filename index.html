<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Web AAC</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background-color: #f0f0f0;
        margin: 0;
        padding: 0;
    }
    header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: #333;
        color: white;
        padding: 10px 20px;
    }
    header h1 { margin: 0; }
    header button { padding: 5px 10px; }
    #settings { cursor: pointer; }
    #profile-section, #message-section { padding: 10px 20px; }
    #word-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 8px; margin-top: 10px; }
    .word-btn { padding: 10px; font-size: 16px; cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; }
    #message { width: 100%; font-size: 18px; padding: 8px; margin-top: 10px; }
    #predictions { margin-top: 5px; list-style: none; padding: 0; }
    #predictions li { cursor: pointer; padding: 4px; }
    #predictions li:hover { background: #ddd; }
</style>
</head>
<body>
<header>
    <h1>Web AAC</h1>
    <div>
        <button id="settings">‚öôÔ∏è</button>
        <select id="voiceSelect"></select>
    </div>
</header>

<section id="profile-section">
    <label>Profile:
        <select id="profileSelect"></select>
        <button id="addProfile">Add</button>
        <button id="delProfile">Delete</button>
    </label>
    <input type="color" id="bgColorPicker" value="#f0f0f0">
</section>

<section id="message-section">
    <textarea id="message" rows="3" placeholder="Type your message..."></textarea>
    <ul id="predictions"></ul>
    <button id="speakBtn">Speak</button>
    <div id="word-grid"></div>
</section>

<script>
// ==================== WORD DATA ====================
const CATEGORIES = {
    "Core": { "I":"üë§","You":"ü´µ","We":"üë•","They":"üë•","Go":"üèÉ","Stop":"‚úã","Hello":"üëã","Goodbye":"üëã","Yes":"‚úÖ","No":"‚ùå","Help":"üÜò","Eat":"üçΩÔ∏è","Drink":"ü•§","Want":"ü§≤","Need":"ü§≤","Love":"‚ù§Ô∏è","Like":"üëç","Hate":"üëé","Think":"ü§î","Know":"üß†","See":"üëÄ","Hear":"üëÇ","Feel":"ü§ó","Wait":"‚è≥","Come":"üëê","Leave":"üö™","Play":"üéÆ","Work":"üíº","Read":"üìñ","Write":"‚úèÔ∏è"},
    "Food": { "Apple":"üçé","Banana":"üçå","Bread":"üçû","Milk":"ü•õ","Water":"üíß","Juice":"üßÉ","Rice":"üçö","Meat":"ü•©","Cheese":"üßÄ","Egg":"ü•ö","Soup":"ü•£","Cake":"üç∞","Chocolate":"üç´","Cookie":"üç™","Pizza":"üçï","Burger":"üçî","Fries":"üçü","Fish":"üêü","Vegetables":"ü•¶","Fruit":"üçé","Snack":"üçø"},
    "Feelings": { "Happy":"üòä","Sad":"üò¢","Angry":"üò°","Excited":"ü§©","Tired":"üò¥","Scared":"üò±","Confused":"üòï","Surprised":"üò≤","Bored":"üòê","Love":"‚ù§Ô∏è","Like":"üëç","Dislike":"üëé","Proud":"üòå","Shy":"üò≥","Worried":"üòü","Calm":"üòå","Relaxed":"üòé","Hungry":"ü§§","Thirsty":"üòã"},
    "Places": { "Home":"üè†","School":"üè´","Park":"üèûÔ∏è","Bathroom":"üöΩ","Kitchen":"üç≥","Bedroom":"üõèÔ∏è","Store":"üè™","Office":"üè¢","Hospital":"üè•","Library":"üìö","Playground":"üõù","Garden":"üå≥","Beach":"üèñÔ∏è","Mountain":"‚õ∞Ô∏è","City":"üèôÔ∏è","Village":"üèòÔ∏è","Market":"üõí","Restaurant":"üç¥","Cafe":"‚òï","Theater":"üé≠"},
    "Activities": { "Run":"üèÉ","Walk":"üö∂","Jump":"ü§æ","Swim":"üèä","Dance":"üíÉ","Sing":"üé§","Draw":"üñåÔ∏è","Paint":"üé®","Cook":"üç≥","Read":"üìñ","Write":"‚úèÔ∏è","Study":"üìö","Sleep":"üò¥","Play":"üéÆ","Exercise":"üèãÔ∏è","Travel":"‚úàÔ∏è","Shop":"üõçÔ∏è","Drive":"üöó","Watch":"üëÄ","Listen":"üëÇ"},
    "Animals": { "Dog":"üê∂","Cat":"üê±","Bird":"üê¶","Fish":"üêü","Horse":"üê¥","Cow":"üêÑ","Pig":"üêñ","Sheep":"üêë","Rabbit":"üêá","Monkey":"üêí","Lion":"ü¶Å","Tiger":"üêÖ","Elephant":"üêò","Bear":"üêª","Wolf":"üê∫","Frog":"üê∏","Snake":"üêç","Fox":"ü¶ä","Deer":"ü¶å","Whale":"üêã"},
};

// ==================== STATE ====================
let profiles = JSON.parse(localStorage.getItem('profiles')||'{}');
let currentProfile = null;
let allWords = [];
for (let cat in CATEGORIES) allWords.push(...Object.keys(CATEGORIES[cat]));

// ==================== PROFILE FUNCTIONS ====================
function refreshProfiles() {
    const sel = document.getElementById('profileSelect');
    sel.innerHTML = '';
    Object.keys(profiles).forEach(p => {
        const opt = document.createElement('option');
        opt.value = p; opt.textContent = p;
        sel.appendChild(opt);
    });
    if (!currentProfile && Object.keys(profiles).length) currentProfile = Object.keys(profiles)[0];
    sel.value = currentProfile;
}
function addProfile() {
    const name = prompt("Profile Name?");
    if (!name) return;
    profiles[name] = { words:{} };
    currentProfile = name;
    localStorage.setItem('profiles', JSON.stringify(profiles));
    refreshProfiles(); buildGrid();
}
function delProfile() {
    if (!currentProfile) return;
    delete profiles[currentProfile];
    currentProfile = Object.keys(profiles)[0] || null;
    localStorage.setItem('profiles', JSON.stringify(profiles));
    refreshProfiles(); buildGrid();
}

// ==================== GRID ====================
function buildGrid() {
    const grid = document.getElementById('word-grid');
    grid.innerHTML = '';
    let words = {};
    Object.assign(words, ...Object.values(CATEGORIES));
    for (let w in words) {
        const btn = document.createElement('button');
        btn.className = 'word-btn';
        btn.innerHTML = `${w}<br>${words[w]}`;
        btn.onclick = () => addWordToMessage(w);
        grid.appendChild(btn);
    }
}

// ==================== MESSAGE & PREDICTION ====================
function addWordToMessage(word) {
    const msg = document.getElementById('message');
    msg.value = msg.value ? msg.value + ' ' + word : word;
    predict();
}

function predict() {
    const msg = document.getElementById('message').value.trim();
    const last = msg.split(' ').pop().toLowerCase();
    const list = document.getElementById('predictions');
    list.innerHTML = '';
    if (!last) return;
    const matches = allWords.filter(w => w.toLowerCase().startsWith(last) && w.toLowerCase()!==last).slice(0,6);
    matches.forEach(m => {
        const li = document.createElement('li');
        li.textContent = m;
        li.onclick = ()=> { addWordToMessage(m); list.innerHTML=''; };
        list.appendChild(li);
    });
}

// ==================== TTS ====================
function speakMessage() {
    const msg = document.getElementById('message').value.trim();
    if (!msg) return;
    const utter = new SpeechSynthesisUtterance(msg);
    const voiceSel = document.getElementById('voiceSelect');
    const voiceId = voiceSel.value;
    if (voiceId) utter.voice = speechSynthesis.getVoices().find(v=>v.name===voiceId);
    speechSynthesis.speak(utter);
}

// ==================== INIT ====================
document.getElementById('addProfile').onclick = addProfile;
document.getElementById('delProfile').onclick = delProfile;
document.getElementById('speakBtn').onclick = speakMessage;
document.getElementById('message').addEventListener('input', predict);
document.getElementById('profileSelect').addEventListener('change', e=>{ currentProfile=e.target.value; buildGrid(); });

document.getElementById('bgColorPicker').addEventListener('input', e=>{
    document.body.style.backgroundColor = e.target.value;
});

// Load voices
function loadVoices() {
    const voices = speechSynthesis.getVoices();
    const sel = document.getElementById('voiceSelect');
    sel.innerHTML = '';
    voices.forEach(v => {
        const opt = document.createElement('option');
        opt.value = v.name; opt.textContent = v.name;
        sel.appendChild(opt);
    });
}
speechSynthesis.onvoiceschanged = loadVoices;

// Initial load
refreshProfiles(); buildGrid();
</script>
</body>
</html>
